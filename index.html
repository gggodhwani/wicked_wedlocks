<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8 />
		<title>Data</title>
		<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
		<script src='assets/js/mapbox.js'></script>
		<link href='assets/css/mapbox.css' rel='stylesheet' />
		<style>
			body { margin:0; padding:0; }
    			#map { position:absolute; top:0; bottom:0; width:100%; }
		</style>
	</head>
	<body>
		<script src='assets/js/leaflet-omnivore.min.js'></script>
		<script src='assets/data/js/districts_data.js'></script>
		<div id='map'></div>
		<script>
			var map = L.mapbox.map('map').setView([22, 78], 5);
			L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
					    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
					    }).addTo(map);
			var customLayer = L.geoJson(null, {style: getStyle});
			var districtLayer = omnivore.topojson('assets/data/json/district_boundaries.json', null, customLayer).addTo(map);
			function getStyle(feature) {
				return {
					weight: 1,
					opacity: 0.25,
				       	color: 'black',
					fillOpacity: 0.65,
					fillColor: getColor(feature.properties.id)
          			};
  			}			      
			function getColor(districtId) {
				console.log(districtId);
				if(!districtsData[districtId]){
					ratio = 0;	
				}
				else{
					ratio = (districtsData[districtId]["t"]["rf"] + districtsData[districtId]["t"]["rm"])/2.0;
				}
				return ratio > 0.05 ? '#000000' :
				ratio > 0.04  ? '#660000' :
				ratio > 0.03  ? '#FF6600' :
				ratio > 0.02  ? '#99FF33' :
				ratio > 0.01   ? '#19A319' :
				ratio > 0.005   ? '#003D00' :
				ratio > 0.0025   ? '#002900' :
				ratio == 0 ? '#FFFFFF':
				'#C2C2A3';
			}	
		</script>
	</body>
</html>		
